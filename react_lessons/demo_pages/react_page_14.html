<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>React Hooks: useEffect, useCallback, useMemo</title>
  </head>
  <body>
    <div class="root"></div>
    <script
      crossorigin
      src="https://unpkg.com/react@16/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel">
      // using React.memo to prevent unnecessary re-renders if props don't change
      const FilterInput = React.memo(({ onFilterChange }) => {
        console.log("FilterInput render");
        return (
          <input
            type="text"
            placeholder="Filter items..."
            onChange={onFilterChange}
            style={{ marginBottom: "10px", padding: "8px" }}
          />
        );
      });

      // using React.memo to prevent unnecessary re-renders if props don't change
      const ItemList = React.memo(({ items }) => {
        console.log("ItemList render");
        return (
          <ul>
            {items.map((item) => (
              <li key={item.id}>{item.name}</li>
            ))}
          </ul>
        );
      });

      const allItems = [
        { id: 1, name: "Apple" },
        { id: 2, name: "Banana" },
        { id: 3, name: "Cherry" },
        { id: 4, name: "Date" },
        { id: 5, name: "Elderberry" },
      ];

      const App = () => {
        const [filterText, setFilterText] = React.useState("");
        const [count, setCount] = React.useState(0); // just a dummy state to trigger re-renders

        // without useCallback, this function would be re-created on every render of page, even if filterText hasn't changed.
        // this could cause ItemList to re-render if it uses React.memo.
        const handleFilterChange = React.useCallback((event) => {
          setFilterText(event.target.value); // set filter text from input
        }, []); // empty dependency array means this function is created once

        const filteredItems = React.useMemo(() => {
          console.log("Filtering items...");
          return allItems.filter((item) =>
            item.name.toLowerCase().includes(filterText.toLowerCase())
          );
        }, [filterText]); // recalculate only when filterText changes

        return (
          <div>
            <h1>Shopping List ðŸ›’</h1>
            <button onClick={() => setCount((prev) => prev + 1)}>
              Increment Count: {count}
            </button>
            <p>Try typing in the filter or incrementing the count.</p>

            <FilterInput onFilterChange={handleFilterChange} />
            <ItemList items={filteredItems} />
          </div>
        );
      };

      const rootElement = document.querySelector(".root");
      ReactDOM.render(<App />, rootElement);
    </script>
  </body>
</html>
